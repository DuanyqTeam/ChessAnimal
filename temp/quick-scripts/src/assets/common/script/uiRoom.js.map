{"version":3,"sources":["../../../../../assets/common/script/assets/common/script/uiRoom.js"],"names":["uiPanel","require","mvs","GLB","cc","Class","properties","onLoad","_super","players","roomId","roomInfo","owner","playerPrefab","nodeDict","active","on","quit","startGame","clientEvent","eventType","joinRoomNotify","leaveRoomResponse","leaveRoomNotify","kickPlayerResponse","kickPlayerNotify","leaveRoomMedNotify","i","MAX_PLAYER_COUNT","temp","instantiate","parent","roomUserInfo","getComponent","init","push","data","j","length","userId","kickPlayerRsp","userID","userInfo","id","isRoomOwner","uiFunc","closeUI","node","name","destroy","setData","ownerId","leaveRoomRsp","status","console","log","refreshStartBtn","leaveRoomInfo","spNode","btn","Button","color","Color","WHITE","enabled","BLACK","engine","leaveRoom","openUI","obj","uiTip","bind","userIds","playerCnt","result","joinOver","playerUserIds","msg","action","GAME_START_EVENT","Game","GameManager","sendEventEx","createRoomInit","rsp","roomID","joinRoomInit","roomUserInfoList","sort","a","b","onDestroy","off"],"mappings":"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","sourceRoot":"../../../../../assets/common/script","sourcesContent":["var uiPanel = require(\"uiPanel\");\nvar mvs = require(\"Matchvs\");\nvar GLB = require(\"Glb\");\ncc.Class({\n    extends: uiPanel,\n    properties: {},\n\n    onLoad() {\n        this._super();\n        this.players = [];\n        this.roomId = 0;\n        this.roomInfo = null;\n        this.owner = 0;\n        this.playerPrefab = this.nodeDict[\"player\"];\n        this.playerPrefab.active = false;\n        this.nodeDict[\"quit\"].on(\"click\", this.quit, this);\n        this.nodeDict[\"startGame\"].on(\"click\", this.startGame, this);\n\n\n        clientEvent.on(clientEvent.eventType.joinRoomNotify, this.joinRoomNotify, this);\n        clientEvent.on(clientEvent.eventType.leaveRoomResponse, this.leaveRoomResponse, this);\n        clientEvent.on(clientEvent.eventType.leaveRoomNotify, this.leaveRoomNotify, this);\n        clientEvent.on(clientEvent.eventType.kickPlayerResponse, this.kickPlayerResponse, this);\n        clientEvent.on(clientEvent.eventType.kickPlayerNotify, this.kickPlayerNotify, this);\n        clientEvent.on(clientEvent.eventType.leaveRoomMedNotify, this.leaveRoomMedNotify, this);\n\n        for (var i = 0; i < GLB.MAX_PLAYER_COUNT; i++) {\n            var temp = cc.instantiate(this.playerPrefab);\n            temp.active = true;\n            temp.parent = this.nodeDict[\"layout\"];\n            var roomUserInfo = temp.getComponent('roomUserInfo');\n            roomUserInfo.init();\n            this.players.push(roomUserInfo);\n        }\n    },\n\n    kickPlayerResponse: function(data) {\n        for (var j = 0; j < this.players.length; j++) {\n            if (this.players[j].userId === data.kickPlayerRsp.userID) {\n                this.players[j].init();\n                break;\n            }\n        }\n        if (GLB.userInfo.id === data.kickPlayerRsp.userID) {\n            GLB.isRoomOwner = false;\n            uiFunc.closeUI(this.node.name);\n            this.node.destroy();\n        }\n    },\n\n    kickPlayerNotify: function(data) {\n        for (var j = 0; j < this.players.length; j++) {\n            if (this.players[j].userId === data.kickPlayerNotify.userId) {\n                this.players[j].init();\n                break;\n            }\n        }\n\n        if (GLB.userInfo.id === data.kickPlayerNotify.userId) {\n            GLB.isRoomOwner = false;\n            uiFunc.closeUI(this.node.name);\n            this.node.destroy();\n        }\n    },\n\n    joinRoomNotify: function(data) {\n        for (var j = 0; j < this.players.length; j++) {\n            if (this.players[j].userId === 0) {\n                this.players[j].setData(data.roomUserInfo.userId, this.ownerId);\n                break;\n            }\n        }\n    },\n\n    leaveRoomResponse: function(data) {\n        if (data.leaveRoomRsp.status === 200) {\n            console.log(\"离开房间成功！\");\n        } else {\n            console.log(\"离开房间失败\");\n        }\n        GLB.isRoomOwner = false;\n        uiFunc.closeUI(this.node.name);\n        this.node.destroy();\n    },\n\n    leaveRoomMedNotify: function(data) {\n        for (var j = 0; j < this.players.length; j++) {\n            if (this.players[j].userId === data.userID) {\n                this.players[j].init();\n                break;\n            }\n        }\n        this.ownerId = data.owner;\n        if (this.ownerId === GLB.userInfo.id) {\n            GLB.isRoomOwner = true;\n        }\n        for (var i = 0; i < this.players.length; i++) {\n            if (this.players[i].userId !== 0) {\n                this.players[i].setData(this.players[i].userId, this.ownerId);\n            }\n        }\n        this.refreshStartBtn();\n    },\n\n    leaveRoomNotify: function(data) {\n        for (var j = 0; j < this.players.length; j++) {\n            if (this.players[j].userId === data.leaveRoomInfo.userId) {\n                this.players[j].init();\n                break;\n            }\n        }\n        this.ownerId = data.leaveRoomInfo.owner;\n        if (this.ownerId === GLB.userInfo.id) {\n            GLB.isRoomOwner = true;\n        }\n        for (var i = 0; i < this.players.length; i++) {\n            if (this.players[i].userId !== 0) {\n                this.players[i].setData(this.players[i].userId, this.ownerId);\n            }\n        }\n        this.refreshStartBtn();\n    },\n\n    refreshStartBtn() {\n        var spNode = this.nodeDict[\"startGame\"];\n        var btn = this.nodeDict[\"startGame\"].getComponent(cc.Button);\n        if (GLB.isRoomOwner) {\n            spNode.color = cc.Color.WHITE;\n            btn.enabled = true;\n        }else{\n            spNode.color = cc.Color.BLACK;\n            btn.enabled = false;\n        }\n    },\n\n    quit: function() {\n        mvs.engine.leaveRoom(\"\");\n    },\n\n    startGame: function() {\n        if (!GLB.isRoomOwner) {\n            uiFunc.openUI(\"uiTip\", function(obj) {\n                var uiTip = obj.getComponent(\"uiTip\");\n                if (uiTip) {\n                    uiTip.setData(\"等待房主开始游戏\");\n                }\n            }.bind(this));\n            return;\n        }\n        var userIds = [];\n        var playerCnt = 0;\n        for (var j = 0; j < this.players.length; j++) {\n            if (this.players[j].userId !== 0) {\n                playerCnt++;\n                userIds.push(this.players[j].userId);\n            }\n        }\n\n        if (playerCnt === GLB.MAX_PLAYER_COUNT) {\n            var result = mvs.engine.joinOver(\"\");\n            console.log(\"发出关闭房间的通知\");\n            if (result !== 0) {\n                console.log(\"关闭房间失败，错误码：\", result);\n            }\n\n            GLB.playerUserIds = userIds;\n\n            var msg = {\n                action: GLB.GAME_START_EVENT,\n                userIds: userIds\n            };\n            Game.GameManager.sendEventEx(msg);\n        } else {\n            uiFunc.openUI(\"uiTip\", function(obj) {\n                var uiTip = obj.getComponent(\"uiTip\");\n                if (uiTip) {\n                    uiTip.setData(\"房间人数不足\");\n                }\n            }.bind(this));\n        }\n    },\n\n    createRoomInit(rsp) {\n        this.roomId = rsp.roomID;\n        this.ownerId = rsp.owner;\n        this.players[0].setData(this.ownerId, this.ownerId);\n        GLB.isRoomOwner = true;\n        this.refreshStartBtn();\n    },\n\n    joinRoomInit(roomUserInfoList, roomInfo) {\n        roomUserInfoList.sort(function(a, b) {\n            if (roomInfo.ownerId === b.userId) {\n                return 1;\n            }\n            return 0;\n        });\n        this.ownerId = roomInfo.ownerId;\n        for (var j = 0; j < roomUserInfoList.length; j++) {\n            this.players[j].setData(roomUserInfoList[j].userId, this.ownerId);\n        }\n        this.refreshStartBtn();\n    },\n\n    onDestroy() {\n        clientEvent.off(clientEvent.eventType.joinRoomNotify, this.joinRoomNotify, this);\n        clientEvent.off(clientEvent.eventType.leaveRoomResponse, this.leaveRoomResponse, this);\n        clientEvent.off(clientEvent.eventType.leaveRoomNotify, this.leaveRoomNotify, this);\n        clientEvent.off(clientEvent.eventType.kickPlayerResponse, this.kickPlayerResponse, this);\n        clientEvent.off(clientEvent.eventType.kickPlayerNotify, this.kickPlayerNotify, this);\n        clientEvent.off(clientEvent.eventType.leaveRoomMedNotify, this.leaveRoomMedNotify, this);\n\n    }\n});\n"]}