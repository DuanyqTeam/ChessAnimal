{"version":3,"sources":["../../../../../assets/common/script/assets/common/script/uiMaskLayout.js"],"names":["uiPanel","require","cc","Class","start","clientEvent","on","eventType","openUI","uiOperateCallBack","closeUI","isUseMask","node","active","lastMaskIndex","i","uiFunc","uiList","length","ui","panel","getComponent","j","targetUI","setSiblingIndex","Number","MAX_SAFE_INTEGER","console","log","refresh","onDestroy","off"],"mappings":"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","sourceRoot":"../../../../../assets/common/script","sourcesContent":["var uiPanel = require(\"uiPanel\");\ncc.Class({\n    extends: uiPanel,\n    // LIFE-CYCLE CALLBACKS:\n    start() {\n        clientEvent.on(clientEvent.eventType.openUI, this.uiOperateCallBack, this);\n        clientEvent.on(clientEvent.eventType.closeUI, this.uiOperateCallBack, this);\n        this.isUseMask = false;\n        this.node.active = false;\n    },\n\n    uiOperateCallBack: function() {\n        // 最后一个需要使用mask的panel\n        var lastMaskIndex = -1;\n        for (var i = uiFunc.uiList.length - 1; i >= 0; i--) {\n            var ui = uiFunc.uiList[i];\n            var panel = ui.getComponent(\"uiPanel\");\n            if (panel && panel.isUseMask) {\n                lastMaskIndex = i;\n                break;\n            }\n        }\n        if (lastMaskIndex >= 0) {\n            this.node.active = true;\n            for (var j = lastMaskIndex; j < uiFunc.uiList.length; j++) {\n                var targetUI = uiFunc.uiList[j];\n                if (targetUI) {\n                    this.node.setSiblingIndex(Number.MAX_SAFE_INTEGER);\n                    targetUI.setSiblingIndex(Number.MAX_SAFE_INTEGER);\n                } else {\n                    console.log(\"current show ui is null!\");\n                }\n            }\n        } else {\n            this.node.active = false;\n            return;\n        }\n    },\n\n    refresh: function() {\n        // 最后一个需要使用mask的panel\n        var lastMaskIndex = -1;\n        for (var i = uiFunc.uiList.length - 1; i >= 0; i--) {\n            var ui = uiFunc.uiList[i];\n            var panel = ui.getComponent(\"uiPanel\");\n            if (panel.isUseMask) {\n                lastMaskIndex = i;\n                break;\n            }\n        }\n        if (lastMaskIndex >= 0) {\n            this.node.active = true;\n            for (var j = lastMaskIndex; j < uiFunc.uiList.length; j++) {\n                var targetUI = uiFunc.uiList[j];\n                if (targetUI) {\n                    this.node.setSiblingIndex(Number.MAX_SAFE_INTEGER);\n                    targetUI.setSiblingIndex(Number.MAX_SAFE_INTEGER);\n                } else {\n                    console.log(\"current show ui is null!\");\n                }\n            }\n        } else {\n            this.node.active = false;\n            return;\n        }\n    },\n\n    onDestroy: function() {\n        clientEvent.off(clientEvent.eventType.openUI, this.uiOperateCallBack, this);\n        clientEvent.off(clientEvent.eventType.closeUI, this.uiOperateCallBack, this);\n    }\n});\n"]}