{"version":3,"sources":["../../../../../assets/common/script/assets/common/script/uiVsResult.js"],"names":["uiPanel","require","mvs","GLB","cc","Class","properties","loseClip","url","AudioClip","victoryClip","redFrame","SpriteFrame","blueFrame","isWin","flag","audioEngine","play","nodeDict","active","draw","setData","winFlag","PLAYER_FLAG","RED","isRoomOwner","BLUE","Game","GameManager","loginServer","setFrameColor","leftFrameSprite","spriteFrame","rightFrameSprite","start","player","getComponent","playerUserIds","rival","Sprite","on","quit","engine","leaveRoom","gamePanel","uiFunc","findUI","closeUI","destroy","node","name","lobbyShow"],"mappings":"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","sourceRoot":"../../../../../assets/common/script","sourcesContent":["var uiPanel = require(\"uiPanel\");\nvar mvs = require(\"Matchvs\");\nvar GLB = require(\"Glb\");\ncc.Class({\n    extends: uiPanel,\n\n    properties: {\n        loseClip: {\n            default: null,\n            url: cc.AudioClip\n        },\n        victoryClip: {\n            default: null,\n            url: cc.AudioClip\n        },\n        redFrame: cc.SpriteFrame,\n        blueFrame: cc.SpriteFrame,\n    },\n\n    isWin (flag) {\n        if (flag) {\n            cc.audioEngine.play(this.victoryClip, false, 1);\n        } else {\n            cc.audioEngine.play(this.loseClip, false, 1);\n        }\n        this.nodeDict[\"lose\"].active = !flag;\n        this.nodeDict[\"win\"].active = flag;\n        this.nodeDict[\"draw\"].active = false;\n    },\n\n    draw () {\n        this.nodeDict[\"lose\"].active = false;\n        this.nodeDict[\"win\"].active = false;\n        this.nodeDict[\"draw\"].active = true;\n        cc.audioEngine.play(this.victoryClip, false, 1);\n    },\n\n    setData (winFlag) {\n        if (winFlag === GLB.PLAYER_FLAG.RED && GLB.isRoomOwner) {\n            this.isWin(true);\n        } else if (winFlag === GLB.PLAYER_FLAG.BLUE && !GLB.isRoomOwner) {\n            this.isWin(true);\n        } else if (winFlag === null) {\n            this.draw();\n        } else {\n            this.isWin(false);\n            return;\n        }\n        Game.GameManager.loginServer();\n    },\n\n    setFrameColor () {\n        if(GLB.isRoomOwner) {\n            this.leftFrameSprite.spriteFrame = this.redFrame;\n            this.rightFrameSprite.spriteFrame = this.blueFrame;\n        } else {\n            this.leftFrameSprite.spriteFrame = this.blueFrame;\n            this.rightFrameSprite.spriteFrame = this.redFrame;\n        }\n    },\n\n    start() {\n        this.player = this.nodeDict[\"player\"].getComponent(\"resultPlayerIcon\");\n        this.player.setData(GLB.playerUserIds[0]);\n        this.rival = this.nodeDict[\"rival\"].getComponent(\"resultPlayerIcon\");\n        this.rival.setData(GLB.playerUserIds[1]);\n        this.nodeDict[\"vs\"].active = true;\n        this.nodeDict[\"score\"].active = false;\n        this.leftFrameSprite =  this.nodeDict['leftFrame'].getComponent(cc.Sprite);\n        this.rightFrameSprite = this.nodeDict['rightFrame'].getComponent(cc.Sprite);\n        this.setFrameColor();\n        // var gamePanel = uiFunc.findUI(\"uiGamePanel\");\n        // if (gamePanel) {\n        //     var gamePanelScript = gamePanel.getComponent(\"uiGamePanel\");\n        //     this.selfScore = gamePanelScript.selfScore;\n        //     this.otherScore = gamePanelScript.otherScore;\n        // }\n        // if (this.selfScore >= this.otherScore) {\n        //     this.nodeDict[\"lose\"].active = false;\n        //     this.nodeDict[\"win\"].active = true;\n        // } else {\n        //     this.nodeDict[\"lose\"].active = true;\n        //     this.nodeDict[\"win\"].active = false;\n        // }\n        // var isWin = this.selfScore >= this.otherScore;\n        // if (isWin) {\n        //     cc.audioEngine.play(this.victoryClip, false, 1);\n        // } else {\n        //     cc.audioEngine.play(this.loseClip, false, 1);\n        // }\n        //\n        // this.nodeDict[\"playerScore\"].getComponent(cc.Label).string = this.selfScore;\n        // this.nodeDict[\"rivalScore\"].getComponent(cc.Label).string = this.otherScore;\n\n        this.nodeDict[\"quit\"].on(\"click\", this.quit, this);\n\n        // if (isWin) {\n        //     // 发送胜局记录--\n        //     Game.GameManager.loginServer();\n        // }\n    },\n\n    quit: function() {\n        mvs.engine.leaveRoom(\"\");\n        var gamePanel = uiFunc.findUI(\"uiGamePanel\");\n        if (gamePanel) {\n            uiFunc.closeUI(\"uiGamePanel\");\n            gamePanel.destroy();\n        }\n        uiFunc.closeUI(this.node.name);\n        this.node.destroy();\n\n\n        Game.GameManager.lobbyShow();\n    }\n});\n"]}