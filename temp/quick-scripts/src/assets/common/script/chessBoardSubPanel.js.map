{"version":3,"sources":["../../../../../assets/common/script/assets/common/script/chessBoardSubPanel.js"],"names":["GLB","require","pool","cc","Class","Component","properties","chess","Prefab","nextStep","onLoad","createPrefabPool","init","fPosList","chessBoradWidth","node","width","chessBoradHeight","height","rows","columns","longX","longY","x","areaLine","y","pos","v2","push","playing","mapParam01","mapParam02","clientEvent","on","eventType","mapInit","mapInitEvent","eatForChess","eatForChessEvent","eatForOther","openForOther","openChessPiece","openChessPieceEvent","checkMoveDirection","isGameOver","getMap","gameOver","overClear","clearChess","showChessArr","showStepArr","chessBoardList","oldChessNode","childrenNodes","children","val","destroy","removeAllChildren","touchBoardEvent","event","Game","GameManager","gameState","GameState","Play","convertToNodeSpace","getLocation","clickPos","console","log","parseInt","moveTag","chessMove","oldChess","sign","data","left","setEatfun","right","up","down","stepNode","clearDirection","animatPutDown","showChessInfo","param","isRoomOwner","j","length","chessNode","getPrefab","name","addChild","setPosition","chessScript","getComponent","setChessType","type","index","stepScrip","blueChessPiecesArr","redChessPiecesArr","k","stepNodeScrip","chessInfo","xx","Math","random","floor","PLAYER_FLAG","RED","splice","BLUE","msg","action","SEND_MAP_INFO","sendEventEx","msg02","move","cb","callback","getAnimateStep","clearMove","oldTag","oldStepNode","tag","enemyChess","ownerChess","isCanEatChess","currentChessNode","getChessNodeByTag","getStepNodeByTag","setMoveDirection","parm","getTagByIndex","getIsOpen","isEatChess","eatTag","eatOther","user","stepIfEatOrOpen","moveToKong","chessNodeScrip","isOpen","CHANGE_FLAG","EAT_FOR_OTHER","eatInfo","sendEvent","addTag","oldChessScrip","oldStepNodeScrip","getNode","stopAllActions","callF","callFunc","setAudio","clearOldChessNode","bind","runAction","sequence","moveTo","isEatStepChess","ownerStepChess","eatChangePosition","getPosition","pos2","ownerNode","ownerStepNode","index2","getIndex","shiftForBoardList","setDestory","chessSetDestory","zIndex","arrX","arrY","i","getStepByIndex","winFlag","userIsWin","GAME_OVER_EVENT","dispatch","stopTimeWarnAnim","isEatNode","isEatStepNode","scrip","onDestroy","off"],"mappings":"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","sourceRoot":"../../../../../assets/common/script","sourcesContent":["var GLB = require(\"Glb\");\nvar pool = require(\"pool\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        chess: cc.Prefab,\n        nextStep: cc.Prefab\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        pool.createPrefabPool(this.chess);\n        pool.createPrefabPool(this.nextStep);\n        //\n        // this.showChessArr = [];//存棋子\n        // this.showStepArr = [];\n        // this.chessBoardList = [\n        //     [0, 0, 0, 0],\n        //     [0, 0, 0, 0],\n        //     [0, 0, 0, 0],\n        //     [0, 0, 0, 0]\n        // ];\n        this.init();\n        this.fPosList = [];\n\n        this.chessBoradWidth = this.node.width;\n        this.chessBoradHeight = this.node.height;\n        this.rows = 4;\n        this.columns = 4;\n        this.longX = this.chessBoradWidth / this.columns;\n        this.longY = this.chessBoradHeight / this.rows;\n\n\n        //初始化格子坐标\n        for(var x = 0;x <this.rows; x++){\n            var areaLine = [];\n            for(var y = 0; y < this.columns; y++){\n               // var pos = cc.p(-this.chessBoradWidth/2 + y*this.longX + this.longX/2, this.chessBoradHeight/2 - x*this.longY - this.longY/2);\n                var pos = cc.v2(-this.chessBoradWidth/2 + y*this.longX + this.longX/2, this.chessBoradHeight/2 - x*this.longY - this.longY/2 + 5);\n                areaLine[y] = pos;\n            }\n            this.fPosList.push(areaLine);\n        }\n\n        this.playing = false;\n\n        // TODO 加载声音；\n        this.mapParam01 = null;\n        this.mapParam02 = null;\n\n        clientEvent.on(clientEvent.eventType.mapInit, this.mapInitEvent, this);\n        clientEvent.on(clientEvent.eventType.eatForChess, this.eatForChessEvent, this)\n        clientEvent.on(clientEvent.eventType.eatForOther, this.eatForOther, this);\n        clientEvent.on(clientEvent.eventType.openForOther, this.openForOther, this);\n        clientEvent.on(clientEvent.eventType.openChessPiece, this.openChessPieceEvent, this);\n        clientEvent.on(clientEvent.eventType.checkMoveDirection, this.checkMoveDirection, this);\n        clientEvent.on(clientEvent.eventType.isGameOver, this.isGameOver, this);\n        clientEvent.on(clientEvent.eventType.getMap, this.getMap, this);\n        clientEvent.on(clientEvent.eventType.gameOver, this.overClear, this);\n        clientEvent.on(clientEvent.eventType.clearChess, this.overClear, this);\n        // this.node.on('touchend', this.touchBoardEvent, this);\n        //this.getMap();\n    },\n\n    init () {\n        this.showChessArr = [];//存棋子\n        this.showStepArr = [];\n        this.chessBoardList = [\n            [0, 0, 0, 0],\n            [0, 0, 0, 0],\n            [0, 0, 0, 0],\n            [0, 0, 0, 0]\n        ];\n    },\n\n    overClear () {\n        this.mapParam01 = null;\n        this.mapParam02  = null;\n        this.oldChessNode = null;\n        this.chessBoardList = [\n            [0, 0, 0, 0],\n            [0, 0, 0, 0],\n            [0, 0, 0, 0],\n            [0, 0, 0, 0]\n        ];\n        var childrenNodes = this.node.children;\n        for (const val of childrenNodes)  {\n            val.destroy();\n        }\n        this.node.removeAllChildren();\n\n    },\n\n    touchBoardEvent (event) {\n        if (Game.GameManager.gameState !== GameState.Play) return;\n        var pos = this.node.convertToNodeSpace(event.getLocation());\n        var clickPos = {x: pos.y/this.longY,\n            y:pos.x/this.longX};\n        if (clickPos.y%1 < 0.25 || clickPos.y%1 >0.7 || clickPos.x%1 < 0.25 || clickPos.x%1 >0.7 ) {\n            console.log(\"在界外\");\n            // if (this.oldChessNode) {\n            //     this.oldChessNode.clearDirection(true);\n            //     this.oldChessNode.animatPutDown();\n            // }\n            return;\n        }\n        var clickPos = {x:3 - parseInt(clickPos.x),y:parseInt(clickPos.y)};\n        // var moveTag = clickPos.x * 4 + clickPos.y;\n        var moveTag;\n        if (this.chessMove === true){\n            moveTag = {x:parseInt(this.oldChess.sign / 4),y:parseInt(this.oldChess.sign % 4)};\n            if (this.data.left) {\n                if (moveTag.y - 1 === clickPos.y && moveTag.x === clickPos.x) {\n                    this.setEatfun(this.oldChess.sign,null,-1,clickPos);\n                    console.log(\"成功移动\");\n                }\n            }\n            if (this.data.right) {\n                if (moveTag.y + 1 === clickPos.y && moveTag.x === clickPos.x) {\n                    this.setEatfun(this.oldChess.sign,null,1,clickPos);\n                    console.log(\"成功移动\");\n                }\n            }\n            if (this.data.up) {\n                if (moveTag.x  - 1 === clickPos.x && moveTag.y === clickPos.y) {\n                    this.setEatfun(this.oldChess.sign,null,-4,clickPos);\n                    console.log(\"成功移动\");\n                }\n            }\n            if (this.data.down) {\n                if (moveTag.x  + 1  === clickPos.x && moveTag.y === clickPos.y) {\n                    this.setEatfun(this.oldChess.sign,null,4,clickPos);\n                    console.log(\"成功移动\");\n                }\n            }\n        }\n    },\n\n    eatForChessEvent (stepNode) {\n        if (!this.chessMove) return;\n        this.eatForChess(stepNode);\n    },\n\n    openChessPieceEvent (stepNode) {\n        if (this.oldChessNode) {\n            this.oldChessNode.clearDirection();\n            this.oldChessNode.animatPutDown();\n        }\n    },\n\n    mapInitEvent (data) {\n        if(data.showChessInfo) {\n            this.mapParam01 = data.showChessInfo;\n        } else if(data.chessBoardList){\n            this.mapParam02 = data.chessBoardList;\n        }\n        if(this.mapParam01 && this.mapParam02) {\n            var param = {\n                showChessInfo: this.mapParam01,\n                chessBoardList: this.mapParam02\n            }\n            this.mapInit(param);\n        }\n    },\n\n    mapInit (data) {\n        console.log('*******这里是mapInit*********');\n        if(GLB.isRoomOwner) return;\n        this.showChessArr = [];\n        this.showStepArr = []\n        var showChessInfo = data[\"showChessInfo\"];\n        this.chessBoardList = data.chessBoardList;\n        for(var j = 0;j < showChessInfo.length; j++){\n            var chessNode = pool.getPrefab(this.chess.name);\n            this.node.addChild(chessNode);\n            chessNode.setPosition(showChessInfo[j].pos);\n            chessNode.sign = showChessInfo[j].sign;\n            var chessScript = chessNode.getComponent(this.chess.name);\n            this.showChessArr.push(chessNode);\n            chessScript.setChessType(showChessInfo[j].type, showChessInfo[j].index);\n\n            var stepNode = pool.getPrefab(this.nextStep.name);\n            var stepScrip = stepNode.getComponent(this.nextStep.name);\n            this.node.addChild(stepNode);\n            stepScrip.setChessType(showChessInfo[j].type, showChessInfo[j].index);\n            stepNode.setPosition(showChessInfo[j].pos);\n            stepNode.sign = showChessInfo[j].sign;\n            this.showStepArr.push(stepNode);\n        }\n    },\n\n    getMap () {\n        // 主机生成地图数据；\n        if(!GLB.isRoomOwner) return;\n        // // 先清空棋子数据（主机不会收到）；\n        // var chessMsg = {\n        //     action: GLB.CLEAR_CHESS,\n        // }\n        // Game.GameManager.sendEvent(chessMsg)\n\n        this.showChessInfo = [];\n        this.showChessArr = [];\n        this.showStepArr = [];\n        var blueChessPiecesArr = [1,2,3,4,5,6,7,8];\n        var redChessPiecesArr = [11,12,13,14,15,16,17,18];\n\n        for(var j = 0;j <this.rows; j++){\n            for(var k = 0; k < this.columns; k++){\n                var chessNode = pool.getPrefab(this.chess.name);\n                this.node.addChild(chessNode);\n                chessNode.setPosition(this.fPosList[j][k]);\n                chessNode.sign = j*this.columns + k;\n                var chessScript = chessNode.getComponent(this.chess.name);\n                this.showChessArr.push(chessNode);\n\n                var stepNode = pool.getPrefab(this.nextStep.name);\n                var stepNodeScrip =stepNode.getComponent(this.nextStep.name);\n\n                this.node.addChild(stepNode);\n                stepNode.setPosition(this.fPosList[j][k]);\n                stepNode.sign = j*this.columns + k;\n                this.showStepArr.push(stepNode);\n\n                var chessInfo = {pos:this.fPosList[j][k], sign:chessNode.sign};\n                var xx = Math.random();\n                if(xx >= 0.5)\n                {\n                    if(blueChessPiecesArr.length == 0)\n                    {\n                        if(redChessPiecesArr.length == 0)\n                        {\n                            break;\n                        }\n                        var index = Math.floor(Math.random()*redChessPiecesArr.length);\n                        chessScript.setChessType(GLB.PLAYER_FLAG.RED, redChessPiecesArr[index]);\n                        stepNodeScrip.setChessType(GLB.PLAYER_FLAG.RED, redChessPiecesArr[index]);\n                        chessInfo.type = GLB.PLAYER_FLAG.RED;\n                        chessInfo.index = redChessPiecesArr[index];\n                        this.chessBoardList[j][k] = redChessPiecesArr[index];\n                        redChessPiecesArr.splice(index, 1);\n                    }\n                    else\n                    {\n                        var index = Math.floor(Math.random()*blueChessPiecesArr.length);\n                        chessScript.setChessType(GLB.PLAYER_FLAG.BLUE, blueChessPiecesArr[index]);\n                        stepNodeScrip.setChessType(GLB.PLAYER_FLAG.BLUE, blueChessPiecesArr[index]);\n                        chessInfo.type = GLB.PLAYER_FLAG.BLUE;\n                        chessInfo.index = blueChessPiecesArr[index];\n                        this.chessBoardList[j][k] = blueChessPiecesArr[index];\n                        blueChessPiecesArr.splice(index, 1);\n                    }\n\n                }\n                else if(xx < 0.5)\n                {\n                    if(redChessPiecesArr.length == 0)\n                    {\n                        if(blueChessPiecesArr.length == 0)\n                        {\n                            break;\n                        }\n                        var index = Math.floor(Math.random()*blueChessPiecesArr.length);\n                        chessScript.setChessType(GLB.PLAYER_FLAG.BLUE, blueChessPiecesArr[index]);\n                        stepNodeScrip.setChessType(GLB.PLAYER_FLAG.BLUE, blueChessPiecesArr[index]);\n                        chessInfo.type = GLB.PLAYER_FLAG.BLUE;\n                        chessInfo.index = blueChessPiecesArr[index];\n                        this.chessBoardList[j][k] = blueChessPiecesArr[index];\n                        blueChessPiecesArr.splice(index, 1);\n                    }\n                    else{\n                        var index = Math.floor(Math.random()*redChessPiecesArr.length);\n                        chessScript.setChessType(GLB.PLAYER_FLAG.RED, redChessPiecesArr[index]);\n                        stepNodeScrip.setChessType(GLB.PLAYER_FLAG.RED, redChessPiecesArr[index]);\n                        chessInfo.type = GLB.PLAYER_FLAG.RED;\n                        chessInfo.index = redChessPiecesArr[index];\n                        this.chessBoardList[j][k] = redChessPiecesArr[index];\n                        redChessPiecesArr.splice(index, 1);\n                    }\n\n                }\n                this.showChessInfo.push(chessInfo);\n            }\n        }\n        // TODO 派发事件\n        var msg = {\n            action: GLB.SEND_MAP_INFO,\n            showChessInfo: this.showChessInfo,\n            // chessBoardList: this.chessBoardList\n            // mapInfo: {\n            //     showChessInfo: this.showChessInfo,\n            //     chessBoardList: this.chessBoardList\n            // }\n        };\n        Game.GameManager.sendEventEx(msg);\n        var msg02 = {\n            action: GLB.SEND_MAP_INFO,\n            chessBoardList: this.chessBoardList,\n        }\n        Game.GameManager.sendEventEx(msg02)\n    },\n\n    checkMoveDirection (param) {\n        var stepNode = param.node ;\n        var move = param.move;\n        var cb = param.callback;\n        if (this.oldChessNode) {\n            if (this.oldChessNode.getAnimateStep()) {\n                stepNode.getComponent(this.nextStep.name).clearMove();\n                return;\n            }\n        }\n        this.chessMove = move;//为true时是拿起棋子\n        if (this.oldTag !== stepNode.sign) {\n            if (this.oldStepNode) {\n                this.oldStepNode.getComponent(this.nextStep.name).clearMove();\n               this.oldStepNode = null;\n            }\n        }\n        if (this.chessMove === false) {\n            console.log(\"放下棋子\");\n            if (this.oldChessNode) {\n                this.oldChessNode.clearDirection();\n                this.oldChessNode.animatPutDown();\n                this.oldChessNode = null;\n            }\n            return;\n        }\n\n        var data ={left:false,right:false,up:false,down:false};\n        this.data = data;\n        if (this.oldChessNode) {\n            this.oldChessNode.clearDirection(true);\n            this.oldChessNode.animatPutDown();\n        }\n\n\n        var tag = stepNode.sign;\n        this.oldTag = tag;\n        var x = Math.floor(tag/this.columns);\n        var y = tag%this.columns;\n        if(y - 1 >= 0)\n        {\n            // this.checkLeft();\n            var enemyChess = this.chessBoardList[parseInt((tag - 1)/4)][(tag - 1)%4];\n            var ownerChess = this.chessBoardList[parseInt((tag)/4)][(tag)%4];\n            data = this.isCanEatChess(enemyChess,ownerChess, data, \"left\");\n\n        }\n        if(y+1 <= this.columns - 1)\n        {\n            // this.checkRight();\n            var enemyChess = this.chessBoardList[parseInt((tag + 1)/4)][(tag + 1)%4];\n            var ownerChess = this.chessBoardList[parseInt((tag)/4)][(tag)%4];\n            data = this.isCanEatChess(enemyChess,ownerChess, data,\"right\");\n        }\n        if(x-1 >= 0)\n        {\n            // this.checkUp();\n            var enemyChess = this.chessBoardList[parseInt((tag - 4)/4)][(tag - 4)%4];\n            var ownerChess = this.chessBoardList[parseInt((tag)/4)][(tag)%4];\n            data = this.isCanEatChess(enemyChess,ownerChess, data,\"up\");\n        }\n        if(x+1 <= this.rows - 1)\n        {\n            var enemyChess = this.chessBoardList[parseInt((tag + 4)/4)][(tag + 4)%4];\n            var ownerChess = this.chessBoardList[parseInt((tag)/4)][(tag)%4];\n            data = this.isCanEatChess(enemyChess,ownerChess, data,\"down\");\n        }\n\n        this.currentChessNode = this.getChessNodeByTag(tag);\n        this.oldStepNode = this.getStepNodeByTag(tag);\n        this.oldChess = this.currentChessNode;\n        this.oldChessNode = this.currentChessNode.getComponent(this.currentChessNode.name);\n        this.oldChessNode.setMoveDirection(data,cb);\n    },\n\n    //判断子粒大小\n    isCanEatChess:function(enemyChess,ownerChess, data, parm) {\n        if ((parseInt(enemyChess/10) !== parseInt(ownerChess/10)) || (enemyChess === 0)) {\n            if (enemyChess === 0) {\n                data[parm] = true;\n                data[\"largeThan\" + parm] = true;//\n                return data;\n            }\n            var tag = this.getTagByIndex(enemyChess).sign;\n            var stepNode = this.getStepNodeByTag(tag);\n            var stepNodeScrip = stepNode.getComponent(this.nextStep.name);\n            if (!stepNodeScrip.getIsOpen()) {\n                return data;\n            }\n            data[parm] = true;\n            if (enemyChess % 10 > ownerChess % 10) {\n                data[\"largeThan\" + parm] = false;//\n            } else {\n                data[\"largeThan\" + parm] = true;//\n            }\n\n            if (enemyChess % 10 === 8 && ownerChess % 10 === 1) {\n                data[\"largeThan\" + parm] = true;//\n            } else if (ownerChess % 10 === 8 && enemyChess % 10 === 1) {\n                data[\"largeThan\" + parm] = false;//\n            }\n\n        }\n        return data;\n    },\n\n    eatForChess:function(isEatChess) {\n        if (!this.chessMove) return;\n        if (!this.oldChess) {\n            return;\n        }\n        var oldTag = this.oldChess.sign;\n        if(this.data.left)\n        {\n            if (typeof oldTag !== \"undefined\" && ((isEatChess.sign + 1) === oldTag)) {\n                this.setEatfun(oldTag,isEatChess.sign,-1);\n            }\n        }\n        if(this.data.right)\n        {\n\n            if (typeof oldTag !== \"undefined\" && (isEatChess.sign - 1 === oldTag)) {\n                this.setEatfun(oldTag,isEatChess.sign,1);\n            }\n        }\n        if(this.data.up)\n        {\n            if (typeof oldTag !== \"undefined\" && (isEatChess.sign + 4 === oldTag)) {\n                this.setEatfun(oldTag,isEatChess.sign,-4);\n            }\n        }\n        if(this.data.down)\n        {\n            if (typeof oldTag !== \"undefined\" && (isEatChess.sign - 4 === oldTag)) {\n                this.setEatfun(oldTag,isEatChess.sign,4);\n            }\n        }\n    },\n\n    eatForOther (data) {\n        if (data.eatTag !== null) {\n            this.eatOther(data.oldTag,data.eatTag,data.sign);\n            user.stepIfEatOrOpen(1);\n        } else {\n            this.moveToKong(data.oldTag,data.sign,data.clickPos);\n            user.stepIfEatOrOpen(3);\n        }\n    },\n\n    openForOther (tag) {\n        var stepNode = this.getStepNodeByTag(tag);\n        var chessNode = this.getChessNodeByTag(tag);\n        var stepNodeScrip = stepNode.getComponent(this.nextStep.name);\n        var chessNodeScrip = chessNode.getComponent(this.chess.name);\n        if(stepNodeScrip.isOpen) return;\n        stepNodeScrip.openChessPiece();\n        chessNodeScrip.openChessPiece();\n    },\n\n    setEatfun:function(oldTag,eatTag,tag,clickPos){\n        if (eatTag !== null) {\n\n            var msg = {action: GLB.CHANGE_FLAG};\n            Game.GameManager.sendEventEx(msg);\n            // user.isMyTurn = false;\n            this.eatOther(oldTag,eatTag,tag);//吃敌方\n            user.stepIfEatOrOpen(1);\n\n        } else {\n            // user.isMyTurn = false;\n\n            var msg = {action: GLB.CHANGE_FLAG};\n            Game.GameManager.sendEventEx(msg);\n            this.moveToKong(oldTag,tag,clickPos);//走空地\n\n        }\n\n        this.chessMove = false;\n\n        // 发送被吃的消息\n        // user.sendGameData(user.gameDataProto.eatOther, {\n        //     oldTag:oldTag,eatTag:eatTag,tag:tag,clickPos:clickPos\n        // });\n        var msg = {\n            action: GLB.EAT_FOR_OTHER,\n            eatInfo: {\n                oldTag: oldTag,eatTag: eatTag,sign: tag,clickPos: clickPos\n            }\n        };\n        Game.GameManager.sendEvent(msg);\n\n        if (eatTag === null) {\n            user.stepIfEatOrOpen(3, true);\n        }\n    },\n\n    moveToKong:function(oldChess,addTag,clickPos) {\n        this.chessBoardList[parseInt(oldChess/4)][parseInt(oldChess%4)] = 0;\n        var oldChessNode = this.getChessNodeByTag(oldChess);\n        var oldStepNode = this.getStepNodeByTag(oldChess);\n        oldChessNode.sign += addTag;\n        oldStepNode.sign += addTag;\n        var oldChessScrip = oldChessNode.getComponent(this.chess.name);\n        var oldStepNodeScrip = oldStepNode.getComponent(this.nextStep.name);\n        let y = clickPos.y;\n        let x = clickPos.x;\n        var pos = cc.v2(-this.chessBoradWidth/2 + y*this.longX + this.longX/2, this.chessBoradHeight/2 - x*this.longY - this.longY/2);\n        // oldChessScrip.getNode().setPosition(pos);\n        oldChessScrip.getNode().stopAllActions();\n        var callF = cc.callFunc(function () {\n            user.setAudio(\"pieceClick\");\n            this.clearOldChessNode(function(){\n                oldStepNodeScrip.getNode().setPosition(pos);\n                this.chessBoardList[clickPos.x][clickPos.y] = oldChessScrip.index + 1;\n                this.isGameOver();\n            }.bind(this));\n        }.bind(this));\n        oldChessScrip.getNode().runAction(cc.sequence(cc.moveTo(0.2,pos),callF));\n        // oldChessScrip.getNode().runAction(cc.moveTo(0.2,pos));\n    },\n\n    eatOther:function(oldTag, eatTag,tag) {\n        var isEatChess = this.getChessNodeByTag(eatTag).getComponent(this.chess.name);\n        var isEatStepChess = this.getStepNodeByTag(eatTag).getComponent(this.nextStep.name);\n        var ownerChess = this.getChessNodeByTag(oldTag).getComponent(this.chess.name);\n        var ownerStepChess = this.getStepNodeByTag(oldTag).getComponent(this.nextStep.name);\n        if (isEatChess.index % 10 > ownerChess.index % 10) {\n            console.log(\"被吃掉\");\n            if ((isEatChess.index % 10 + 1) === 8 && (ownerChess.index % 10 + 1) === 1) {\n                this.eatChangePosition(ownerChess, ownerStepChess, isEatChess, isEatStepChess, 1, tag);\n            } else {\n                this.eatChangePosition(ownerChess, ownerStepChess, isEatChess, isEatStepChess, -1, tag);\n            }\n\n        } else if (isEatChess.index % 10 + 1 === ownerChess.index % 10 + 1) {\n            this.eatChangePosition(ownerChess, ownerStepChess, isEatChess, isEatStepChess, 0, tag);\n            console.log(\"换掉\");\n            user.stepIfEatOrOpen(1);\n        } else {\n            if (isEatChess.index % 10 + 1 === 1 && ownerChess.index % 10 + 1 === 8) {\n                this.eatChangePosition(ownerChess, ownerStepChess, isEatChess, isEatStepChess, -1, tag);\n            } else {\n                this.eatChangePosition(ownerChess, ownerStepChess, isEatChess, isEatStepChess, 1, tag);\n            }\n\n            console.log(\"吃掉对方\");\n        }\n\n    },\n\n    eatChangePosition:function(ownerChess,ownerStepChess,isEatChess,isEatStepChess, parm,tag) {\n        var pos = isEatChess.getPosition();\n        var pos2 = isEatStepChess.getPosition();\n        var ownerNode = ownerChess.getNode();\n        if (parm > 0) {\n            ownerNode.stopAllActions();\n            ownerNode.runAction(cc.sequence(cc.moveTo(0.2,pos),cc.callFunc(function() {\n                // TODO 播放音乐\n                user.setAudio(\"eat\");\n                this.clearOldChessNode(function(){\n                    ownerNode.sign += tag;\n                    var ownerStepNode = ownerStepChess.getNode();\n                    ownerStepNode.sign += tag;\n                    ownerNode.stopAllActions();\n                    ownerNode.runAction(cc.moveTo(0.2,pos));\n                    // ownerChess.setPosition(pos);\n                    ownerStepChess.setPosition(pos2);\n                    var index2 = isEatChess.getIndex();\n                    var index = ownerChess.getIndex();\n                    this.shiftForBoardList(index);\n                    this.shiftForBoardList(index2,index);\n                    isEatChess.setDestory();\n                    isEatStepChess.setDestory();\n                    this.chessSetDestory(null,null,isEatChess,isEatStepChess);\n                    this.isGameOver();\n                }.bind(this));\n            }.bind(this))));\n        } else if (parm === 0) {\n            ownerNode.zIndex = 100;\n            ownerNode.stopAllActions();\n            ownerNode.runAction(cc.sequence(cc.moveTo(0.2,pos),cc.callFunc(function() {\n                // TODO 播放音乐\n                user.setAudio(\"allDie\");\n                this.clearOldChessNode(function(){\n                    var index = isEatChess.getIndex();\n                    this.shiftForBoardList(index);\n                    index = ownerChess.getIndex();\n                    this.shiftForBoardList(index);\n                    isEatChess.setDestory();\n                    isEatStepChess.setDestory();\n                    ownerChess.setDestory();\n                    ownerStepChess.setDestory();\n                    this.chessSetDestory(ownerChess,ownerStepChess,isEatChess,isEatStepChess);\n                    this.isGameOver();\n                }.bind(this),1);\n            }.bind(this))));\n        } else {\n            ownerNode.zIndex = 100;\n            ownerNode.stopAllActions();\n            ownerNode.runAction(cc.sequence(cc.moveTo(0.2,pos),cc.callFunc(function(){\n                // TODO 播放音乐\n                user.setAudio(\"eat\");\n                this.clearOldChessNode(function(){\n                    var index = ownerChess.getIndex();\n                    this.shiftForBoardList(index);\n                    ownerChess.setDestory();\n                    ownerStepChess.setDestory();\n                    this.chessSetDestory(ownerChess,ownerStepChess,null,null);\n                    this.isGameOver();\n                }.bind(this), 1);\n            }.bind(this))));\n\n        }\n\n    },\n\n    isGameOver:function(){\n        var x,y;\n        var arrX = [], arrY = [];\n        var i;\n        for (i = 0; i < this.chessBoardList.length; i++) {\n            for (var j = 0; j < this.chessBoardList[i].length; j++) {\n                if (this.chessBoardList[i][j] <=0) {\n                    continue;\n                }\n\n                // 判断是否有未开的棋子\n                var isOpen = this.getStepByIndex(this.chessBoardList[i][j]).getComponent(\"nextStep\").getIsOpen();\n                if (!isOpen) {\n                    return;\n                }\n\n                // 判断是否只有一方的棋子\n                if (this.chessBoardList[i][j] >= 10) {      // 红色\n                    x = true;\n                    arrX.push(this.chessBoardList[i][j]);\n                } else if (this.chessBoardList[i][j] > 0){      // 蓝色\n                    y = true;\n                    arrY.push(this.chessBoardList[i][j]);\n                }\n            }\n        }\n\n        // 判断是否只剩下两个开着的子\n        if (arrX.length === 1 && arrY.length === 1) {\n            if (arrX[0] - 10 > arrY[0]) {\n                y = false;\n            } else if (arrX[0] - 10 < arrY[0]) {\n                x = false;\n            } else {\n                x = false;\n                y = false;\n            }\n        }\n\n        if (!x || !y) {\n            // TODO 判断输赢\n            console.log('游戏结束')\n            var winFlag = null;\n            var userIsWin = false;\n            // user.gameOver = true;\n            // Game.GameManager.gameState = GameState.Over;\n            if (!x && !y) {\n                console.log(\"和局\");\n                // clientEvent.dispatchEvent(\"resultDown\",\"2\");\n            } else {\n                if (!GLB.isRoomOwner && !y) {  // 红方赢了\n                    console.log(\"你输了\");\n                    winFlag = GLB.PLAYER_FLAG.RED;\n                //    clientEvent.dispatchEvent(\"resultDown\",\"3\");\n                } else if (GLB.isRoomOwner && !x) {  // 蓝色方赢了\n                    console.log(\"你输了\");\n                    winFlag = GLB.PLAYER_FLAG.BLUE;\n                //    clientEvent.dispatchEvent(\"resultDown\",\"3\");\n                } else {\n                    console.log(\"你赢了\");\n                    var userIsWin = true;\n                //    clientEvent.dispatchEvent(\"resultDown\",\"1\");\n                }\n            }\n            if (userIsWin) {\n                if (GLB.isRoomOwner) {\n                    winFlag = GLB.PLAYER_FLAG.RED;\n                } else {\n                    winFlag = GLB.PLAYER_FLAG.BLUE;\n                }\n            }\n            var msg = {\n                action: GLB.GAME_OVER_EVENT,\n                winFlag: winFlag\n            }\n            Game.GameManager.sendEventEx(msg);\n            clientEvent.dispatch(clientEvent.eventType.stopTimeWarnAnim);\n        }\n    },\n\n    chessSetDestory:function(ownerChess,ownerStepChess,isEatChess,isEatStepChess) {\n        if (ownerChess !== null && ownerStepChess !== null) {\n            var ownerNode = ownerChess.getNode();\n            ownerNode.sign = 100;\n            var ownerStepNode = ownerStepChess.getNode();\n            ownerStepNode.sign = 100;\n        }\n        if (isEatChess !== null && isEatStepChess !== null) {\n            var isEatNode = isEatChess.getNode();\n            isEatNode.sign = 100;\n            var isEatStepNode = isEatStepChess.getNode();\n            isEatStepNode.sign = 100;\n        }\n    },\n\n    shiftForBoardList:function(index,index2) {\n        for (var i = 0; i < this.chessBoardList.length;i++) {\n            for (var j = 0; j < this.chessBoardList[i].length;j++) {\n                if (this.chessBoardList[i][j] === index) {\n                    if (index === 0) {\n                        console.log(\"this.chessBoardList[i][j]出错\");\n                    }\n                    if (index2) {\n                        this.chessBoardList[i][j] = index2;\n                    } else {\n                        this.chessBoardList[i][j] = 0;\n                    }\n\n                }\n            }\n\n        }\n    },\n\n    clearOldChessNode:function(cb,parm) {\n        if (this.oldStepNode) {\n            this.oldStepNode.getComponent(this.nextStep.name).clearMove();\n            this.oldStepNode = null;\n        }\n        if (this.oldChessNode) {\n            this.oldChessNode.clearDirection();\n            this.oldChessNode.animatPutDown(cb,parm);\n        } else {\n            if (cb){\n                cb();\n            }\n        }\n    },\n\n    getChessNodeByTag:function (tag) {\n        for(var i = 0; i < this.showChessArr.length; i++)\n        {\n            if(this.showChessArr[i].sign === tag)\n            {\n                return this.showChessArr[i];\n            }\n        }\n    },\n\n    getStepNodeByTag:function (tag) {\n        for(var i = 0; i < this.showStepArr.length; i++)\n        {\n            if(this.showStepArr[i].sign === tag)\n            {\n                return this.showStepArr[i];\n            }\n        }\n    },\n\n    getStepByIndex:function (index) {\n        for(var i = 0; i < this.showStepArr.length; i++)\n        {\n            var scrip = this.showStepArr[i].getComponent(this.nextStep.name);\n            if(scrip.getIndex() === index)\n            {\n                return this.showStepArr[i];\n            }\n        }\n    },\n\n    getTagByIndex:function (index) {\n        for(var i = 0; i < this.showChessArr.length; i++)\n        {\n            var scrip = this.showChessArr[i].getComponent(this.chess.name);\n            if(scrip.getIndex() === index)\n            {\n                return this.showChessArr[i];\n            }\n        }\n    },\n\n    onDestroy () {\n        clientEvent.off(clientEvent.eventType.mapInit, this.mapInitEvent, this);\n        clientEvent.off(clientEvent.eventType.eatForChess, this.eatForChessEvent, this)\n        clientEvent.off(clientEvent.eventType.eatForOther, this.eatForOther, this);\n        clientEvent.off(clientEvent.eventType.openForOther, this.openForOther, this);\n        clientEvent.off(clientEvent.eventType.openChessPiece, this.openChessPieceEvent, this);\n        clientEvent.off(clientEvent.eventType.checkMoveDirection, this.checkMoveDirection, this);\n        clientEvent.off(clientEvent.eventType.isGameOver, this.isGameOver, this);\n        clientEvent.off(clientEvent.eventType.getMap, this.getMap, this);\n        clientEvent.off(clientEvent.eventType.gameOver, this.overClear, this);\n        clientEvent.off(clientEvent.eventType.clearChess, this.overClear, this);\n        // this.node.off('touchend', this.touchBoardEvent, this);\n    }\n    // start () {\n    //\n    // },\n\n    // update (dt) {},\n});\n"]}