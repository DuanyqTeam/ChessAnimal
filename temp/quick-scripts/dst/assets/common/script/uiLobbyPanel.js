
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/common/script/uiLobbyPanel.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'a5e20CGbKhAx5GXgmsgxPm/', 'uiLobbyPanel');
// common/script/uiLobbyPanel.js

"use strict";

var uiPanel = require("uiPanel");

var mvs = require("Matchvs");

var GLB = require("Glb");

cc.Class({
  "extends": uiPanel,
  properties: {},
  start: function start() {
    this.nodeDict["randomRoom"].on("click", this.randomRoom, this);
    this.nodeDict["createRoom"].on("click", this.createRoom, this);
    this.nodeDict["joinRoom"].on("click", this.joinRoom, this);
    this.nodeDict["inviteFriend"].on("click", this.inviteFriend, this);
    this.nodeDict["exit"].on("click", this.exit, this);
    this.nodeDict["name"].getComponent(cc.Label).string = GLB.userInfo.id;
    this.nodeDict["rank"].on("click", this.rank, this);

    if (Game.GameManager.nickName) {
      this.nodeDict["name"].getComponent(cc.Label).string = Game.GameManager.nickName;
    } else {
      this.nodeDict["name"].getComponent(cc.Label).string = GLB.userInfo.id;
    }

    if (Game.GameManager.avatarUrl) {
      cc.loader.load({
        url: Game.GameManager.avatarUrl,
        type: 'png'
      }, function (err, texture) {
        var spriteFrame = new cc.SpriteFrame(texture, cc.Rect(0, 0, texture.width, texture.height));

        if (this.node) {
          this.nodeDict["userIcon"].getComponent(cc.Sprite).spriteFrame = spriteFrame;
        }
      }.bind(this));
    }

    if (!Game.GameManager.network.isConnected()) {
      Game.GameManager.network.connect(GLB.IP, GLB.PORT, function () {
        Game.GameManager.network.send("connector.entryHandler.login", {
          "account": GLB.userInfo.id + "",
          "channel": "0",
          "userName": Game.GameManager.nickName ? Game.GameManager.nickName : GLB.userInfo.id + "",
          "headIcon": Game.GameManager.avatarUrl ? Game.GameManager.avatarUrl : "-"
        });
      });
    }
  },
  rank: function rank() {
    Game.GameManager.blockInput();

    if (!Game.GameManager.network.isConnected()) {
      Game.GameManager.network.connect(GLB.IP, GLB.PORT, function () {
        Game.GameManager.network.send("connector.entryHandler.login", {
          "account": GLB.userInfo.id + "",
          "channel": "0",
          "userName": Game.GameManager.nickName ? Game.GameManager.nickName : GLB.userInfo.id + "",
          "headIcon": Game.GameManager.avatarUrl ? Game.GameManager.avatarUrl : "-"
        });
        setTimeout(function () {
          Game.GameManager.network.send("connector.rankHandler.getRankData", {
            "account": GLB.userInfo.id + "",
            "game": "game8"
          });
        }, 500);
      });
    } else {
      Game.GameManager.network.send("connector.rankHandler.getRankData", {
        "account": GLB.userInfo.id + "",
        "game": "game8"
      });
    }
  },
  exit: function exit() {
    mvs.engine.logout("");
    uiFunc.closeUI(this.node.name);
    this.node.destroy();
  },
  onEnable: function onEnable() {
    GLB.isRoomOwner = false;
    GLB.MAX_PLAYER_COUNT = 2;
  },
  randomRoom: function randomRoom() {
    Game.GameManager.blockInput();
    GLB.matchType = GLB.RANDOM_MATCH; // 修改匹配方式为随机匹配

    console.log('开始随机匹配');

    if (GLB.gameType === GLB.COOPERATION) {
      if (GLB.MAX_PLAYER_COUNT > 1) {
        if (cc.Canvas.instance.designResolution.height > cc.Canvas.instance.designResolution.width) {
          uiFunc.openUI("uiMatchingVer", function (obj) {
            var matching = obj.getComponent("uiMatching");
            matching.joinRandomRoom();
          });
        } else {
          uiFunc.openUI("uiMatching", function (obj) {
            var matching = obj.getComponent("uiMatching");
            matching.joinRandomRoom();
          });
        }
      } else {
        cc.director.loadScene('game');
      }
    } else if (GLB.gameType === GLB.COMPETITION) {
      if (GLB.MAX_PLAYER_COUNT === 2) {
        if (cc.Canvas.instance.designResolution.height > cc.Canvas.instance.designResolution.width) {
          uiFunc.openUI("uiMatching1v1Ver", function (obj) {
            var matching = obj.getComponent("uiMatching1v1Ver");
            matching.joinRandomRoom();
          });
        } else {
          uiFunc.openUI("uiMatching1v1", function (obj) {
            var matching = obj.getComponent("uiMatching1v1");
            matching.joinRandomRoom();
          });
        }
      } else if (GLB.MAX_PLAYER_COUNT === 4) {
        if (cc.Canvas.instance.designResolution.height > cc.Canvas.instance.designResolution.width) {
          uiFunc.openUI("uiMatching2v2Ver", function (obj) {
            var matching = obj.getComponent("uiMatching2v2Ver");
            matching.joinRandomRoom();
          });
        } else {
          uiFunc.openUI("uiMatching2v2Ver", function (obj) {
            var matching = obj.getComponent("uiMatching2v2Ver");
            matching.joinRandomRoom();
          });
        }
      }
    }
  },
  createRoom: function createRoom() {
    if (cc.Canvas.instance.designResolution.height > cc.Canvas.instance.designResolution.width) {
      uiFunc.openUI("uiCreateRoomVer");
    } else {
      uiFunc.openUI("uiCreateRoom");
    }
  },
  joinRoom: function joinRoom() {
    if (cc.Canvas.instance.designResolution.height > cc.Canvas.instance.designResolution.width) {
      uiFunc.openUI("uiRoomListVer");
    } else {
      uiFunc.openUI("uiRoomList");
    }
  },
  inviteFriend: function inviteFriend() {
    if (window.wx) {
      wx.shareAppMessage({
        imageUrl: "https://data.tianziyou.com/matchvsGamesRes/logo/animalCheckerLogo1.png"
      });
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2Fzc2V0cy9jb21tb24vc2NyaXB0L2Fzc2V0cy9jb21tb24vc2NyaXB0L3VpTG9iYnlQYW5lbC5qcyJdLCJuYW1lcyI6WyJ1aVBhbmVsIiwicmVxdWlyZSIsIm12cyIsIkdMQiIsImNjIiwiQ2xhc3MiLCJwcm9wZXJ0aWVzIiwic3RhcnQiLCJub2RlRGljdCIsIm9uIiwicmFuZG9tUm9vbSIsImNyZWF0ZVJvb20iLCJqb2luUm9vbSIsImludml0ZUZyaWVuZCIsImV4aXQiLCJnZXRDb21wb25lbnQiLCJMYWJlbCIsInN0cmluZyIsInVzZXJJbmZvIiwiaWQiLCJyYW5rIiwiR2FtZSIsIkdhbWVNYW5hZ2VyIiwibmlja05hbWUiLCJhdmF0YXJVcmwiLCJsb2FkZXIiLCJsb2FkIiwidXJsIiwidHlwZSIsImVyciIsInRleHR1cmUiLCJzcHJpdGVGcmFtZSIsIlNwcml0ZUZyYW1lIiwiUmVjdCIsIndpZHRoIiwiaGVpZ2h0Iiwibm9kZSIsIlNwcml0ZSIsImJpbmQiLCJuZXR3b3JrIiwiaXNDb25uZWN0ZWQiLCJjb25uZWN0IiwiSVAiLCJQT1JUIiwic2VuZCIsImJsb2NrSW5wdXQiLCJzZXRUaW1lb3V0IiwiZW5naW5lIiwibG9nb3V0IiwidWlGdW5jIiwiY2xvc2VVSSIsIm5hbWUiLCJkZXN0cm95Iiwib25FbmFibGUiLCJpc1Jvb21Pd25lciIsIk1BWF9QTEFZRVJfQ09VTlQiLCJtYXRjaFR5cGUiLCJSQU5ET01fTUFUQ0giLCJjb25zb2xlIiwibG9nIiwiZ2FtZVR5cGUiLCJDT09QRVJBVElPTiIsIkNhbnZhcyIsImluc3RhbmNlIiwiZGVzaWduUmVzb2x1dGlvbiIsIm9wZW5VSSIsIm9iaiIsIm1hdGNoaW5nIiwiam9pblJhbmRvbVJvb20iLCJkaXJlY3RvciIsImxvYWRTY2VuZSIsIkNPTVBFVElUSU9OIiwid2luZG93Iiwid3giLCJzaGFyZUFwcE1lc3NhZ2UiLCJpbWFnZVVybCJdLCJtYXBwaW5ncyI6Ijs7Ozs7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c291cmNlUm9vdCI6Ii4uLy4uLy4uLy4uLy4uL2Fzc2V0cy9jb21tb24vc2NyaXB0Iiwic291cmNlc0NvbnRlbnQiOlsidmFyIHVpUGFuZWwgPSByZXF1aXJlKFwidWlQYW5lbFwiKTtcbnZhciBtdnMgPSByZXF1aXJlKFwiTWF0Y2h2c1wiKTtcbnZhciBHTEIgPSByZXF1aXJlKFwiR2xiXCIpO1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IHVpUGFuZWwsXG5cbiAgICBwcm9wZXJ0aWVzOiB7fSxcblxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLm5vZGVEaWN0W1wicmFuZG9tUm9vbVwiXS5vbihcImNsaWNrXCIsIHRoaXMucmFuZG9tUm9vbSwgdGhpcyk7XG4gICAgICAgIHRoaXMubm9kZURpY3RbXCJjcmVhdGVSb29tXCJdLm9uKFwiY2xpY2tcIiwgdGhpcy5jcmVhdGVSb29tLCB0aGlzKTtcbiAgICAgICAgdGhpcy5ub2RlRGljdFtcImpvaW5Sb29tXCJdLm9uKFwiY2xpY2tcIiwgdGhpcy5qb2luUm9vbSwgdGhpcyk7XG4gICAgICAgIHRoaXMubm9kZURpY3RbXCJpbnZpdGVGcmllbmRcIl0ub24oXCJjbGlja1wiLCB0aGlzLmludml0ZUZyaWVuZCwgdGhpcyk7XG4gICAgICAgIHRoaXMubm9kZURpY3RbXCJleGl0XCJdLm9uKFwiY2xpY2tcIiwgdGhpcy5leGl0LCB0aGlzKTtcbiAgICAgICAgdGhpcy5ub2RlRGljdFtcIm5hbWVcIl0uZ2V0Q29tcG9uZW50KGNjLkxhYmVsKS5zdHJpbmcgPSBHTEIudXNlckluZm8uaWQ7XG4gICAgICAgIHRoaXMubm9kZURpY3RbXCJyYW5rXCJdLm9uKFwiY2xpY2tcIiwgdGhpcy5yYW5rLCB0aGlzKTtcbiAgICAgICAgaWYgKEdhbWUuR2FtZU1hbmFnZXIubmlja05hbWUpIHtcbiAgICAgICAgICAgIHRoaXMubm9kZURpY3RbXCJuYW1lXCJdLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gR2FtZS5HYW1lTWFuYWdlci5uaWNrTmFtZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubm9kZURpY3RbXCJuYW1lXCJdLmdldENvbXBvbmVudChjYy5MYWJlbCkuc3RyaW5nID0gR0xCLnVzZXJJbmZvLmlkO1xuICAgICAgICB9XG4gICAgICAgIGlmIChHYW1lLkdhbWVNYW5hZ2VyLmF2YXRhclVybCkge1xuICAgICAgICAgICAgY2MubG9hZGVyLmxvYWQoe3VybDogR2FtZS5HYW1lTWFuYWdlci5hdmF0YXJVcmwsIHR5cGU6ICdwbmcnfSwgZnVuY3Rpb24oZXJyLCB0ZXh0dXJlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNwcml0ZUZyYW1lID0gbmV3IGNjLlNwcml0ZUZyYW1lKHRleHR1cmUsIGNjLlJlY3QoMCwgMCwgdGV4dHVyZS53aWR0aCwgdGV4dHVyZS5oZWlnaHQpKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5ub2RlKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub2RlRGljdFtcInVzZXJJY29uXCJdLmdldENvbXBvbmVudChjYy5TcHJpdGUpLnNwcml0ZUZyYW1lID0gc3ByaXRlRnJhbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfS5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIUdhbWUuR2FtZU1hbmFnZXIubmV0d29yay5pc0Nvbm5lY3RlZCgpKSB7XG4gICAgICAgICAgICBHYW1lLkdhbWVNYW5hZ2VyLm5ldHdvcmsuY29ubmVjdChHTEIuSVAsIEdMQi5QT1JULCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBHYW1lLkdhbWVNYW5hZ2VyLm5ldHdvcmsuc2VuZChcImNvbm5lY3Rvci5lbnRyeUhhbmRsZXIubG9naW5cIiwge1xuICAgICAgICAgICAgICAgICAgICBcImFjY291bnRcIjogR0xCLnVzZXJJbmZvLmlkICsgXCJcIixcbiAgICAgICAgICAgICAgICAgICAgXCJjaGFubmVsXCI6IFwiMFwiLFxuICAgICAgICAgICAgICAgICAgICBcInVzZXJOYW1lXCI6IEdhbWUuR2FtZU1hbmFnZXIubmlja05hbWUgPyBHYW1lLkdhbWVNYW5hZ2VyLm5pY2tOYW1lIDogR0xCLnVzZXJJbmZvLmlkICsgXCJcIixcbiAgICAgICAgICAgICAgICAgICAgXCJoZWFkSWNvblwiOiBHYW1lLkdhbWVNYW5hZ2VyLmF2YXRhclVybCA/IEdhbWUuR2FtZU1hbmFnZXIuYXZhdGFyVXJsIDogXCItXCJcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIHJhbms6IGZ1bmN0aW9uKCkge1xuICAgICAgICBHYW1lLkdhbWVNYW5hZ2VyLmJsb2NrSW5wdXQoKTtcblxuICAgICAgICBpZiAoIUdhbWUuR2FtZU1hbmFnZXIubmV0d29yay5pc0Nvbm5lY3RlZCgpKSB7XG4gICAgICAgICAgICBHYW1lLkdhbWVNYW5hZ2VyLm5ldHdvcmsuY29ubmVjdChHTEIuSVAsIEdMQi5QT1JULCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgR2FtZS5HYW1lTWFuYWdlci5uZXR3b3JrLnNlbmQoXCJjb25uZWN0b3IuZW50cnlIYW5kbGVyLmxvZ2luXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYWNjb3VudFwiOiBHTEIudXNlckluZm8uaWQgKyBcIlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjaGFubmVsXCI6IFwiMFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ1c2VyTmFtZVwiOiBHYW1lLkdhbWVNYW5hZ2VyLm5pY2tOYW1lID8gR2FtZS5HYW1lTWFuYWdlci5uaWNrTmFtZSA6IEdMQi51c2VySW5mby5pZCArIFwiXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImhlYWRJY29uXCI6IEdhbWUuR2FtZU1hbmFnZXIuYXZhdGFyVXJsID8gR2FtZS5HYW1lTWFuYWdlci5hdmF0YXJVcmwgOiBcIi1cIlxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEdhbWUuR2FtZU1hbmFnZXIubmV0d29yay5zZW5kKFwiY29ubmVjdG9yLnJhbmtIYW5kbGVyLmdldFJhbmtEYXRhXCIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImFjY291bnRcIjogR0xCLnVzZXJJbmZvLmlkICsgXCJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImdhbWVcIjogXCJnYW1lOFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSwgNTAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgR2FtZS5HYW1lTWFuYWdlci5uZXR3b3JrLnNlbmQoXCJjb25uZWN0b3IucmFua0hhbmRsZXIuZ2V0UmFua0RhdGFcIiwge1xuICAgICAgICAgICAgICAgIFwiYWNjb3VudFwiOiBHTEIudXNlckluZm8uaWQgKyBcIlwiLFxuICAgICAgICAgICAgICAgIFwiZ2FtZVwiOiBcImdhbWU4XCJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGV4aXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBtdnMuZW5naW5lLmxvZ291dChcIlwiKTtcbiAgICAgICAgdWlGdW5jLmNsb3NlVUkodGhpcy5ub2RlLm5hbWUpO1xuICAgICAgICB0aGlzLm5vZGUuZGVzdHJveSgpO1xuICAgIH0sXG5cbiAgICBvbkVuYWJsZSgpIHtcbiAgICAgICAgR0xCLmlzUm9vbU93bmVyID0gZmFsc2U7XG4gICAgICAgIEdMQi5NQVhfUExBWUVSX0NPVU5UID0gMjtcbiAgICB9LFxuXG4gICAgcmFuZG9tUm9vbTogZnVuY3Rpb24oKSB7XG4gICAgICAgIEdhbWUuR2FtZU1hbmFnZXIuYmxvY2tJbnB1dCgpO1xuXG4gICAgICAgIEdMQi5tYXRjaFR5cGUgPSBHTEIuUkFORE9NX01BVENIOyAvLyDkv67mlLnljLnphY3mlrnlvI/kuLrpmo/mnLrljLnphY1cbiAgICAgICAgY29uc29sZS5sb2coJ+W8gOWni+maj+acuuWMuemFjScpO1xuICAgICAgICBpZiAoR0xCLmdhbWVUeXBlID09PSBHTEIuQ09PUEVSQVRJT04pIHtcbiAgICAgICAgICAgIGlmIChHTEIuTUFYX1BMQVlFUl9DT1VOVCA+IDEpIHtcbiAgICAgICAgICAgICAgICBpZiAoY2MuQ2FudmFzLmluc3RhbmNlLmRlc2lnblJlc29sdXRpb24uaGVpZ2h0ID4gY2MuQ2FudmFzLmluc3RhbmNlLmRlc2lnblJlc29sdXRpb24ud2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdWlGdW5jLm9wZW5VSShcInVpTWF0Y2hpbmdWZXJcIiwgZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2hpbmcgPSBvYmouZ2V0Q29tcG9uZW50KFwidWlNYXRjaGluZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoaW5nLmpvaW5SYW5kb21Sb29tKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHVpRnVuYy5vcGVuVUkoXCJ1aU1hdGNoaW5nXCIsIGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hdGNoaW5nID0gb2JqLmdldENvbXBvbmVudChcInVpTWF0Y2hpbmdcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGluZy5qb2luUmFuZG9tUm9vbSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNjLmRpcmVjdG9yLmxvYWRTY2VuZSgnZ2FtZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKEdMQi5nYW1lVHlwZSA9PT0gR0xCLkNPTVBFVElUSU9OKSB7XG4gICAgICAgICAgICBpZiAoR0xCLk1BWF9QTEFZRVJfQ09VTlQgPT09IDIpIHtcbiAgICAgICAgICAgICAgICBpZiAoY2MuQ2FudmFzLmluc3RhbmNlLmRlc2lnblJlc29sdXRpb24uaGVpZ2h0ID4gY2MuQ2FudmFzLmluc3RhbmNlLmRlc2lnblJlc29sdXRpb24ud2lkdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdWlGdW5jLm9wZW5VSShcInVpTWF0Y2hpbmcxdjFWZXJcIiwgZnVuY3Rpb24ob2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2hpbmcgPSBvYmouZ2V0Q29tcG9uZW50KFwidWlNYXRjaGluZzF2MVZlclwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoaW5nLmpvaW5SYW5kb21Sb29tKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHVpRnVuYy5vcGVuVUkoXCJ1aU1hdGNoaW5nMXYxXCIsIGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hdGNoaW5nID0gb2JqLmdldENvbXBvbmVudChcInVpTWF0Y2hpbmcxdjFcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGluZy5qb2luUmFuZG9tUm9vbSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKEdMQi5NQVhfUExBWUVSX0NPVU5UID09PSA0KSB7XG4gICAgICAgICAgICAgICAgaWYgKGNjLkNhbnZhcy5pbnN0YW5jZS5kZXNpZ25SZXNvbHV0aW9uLmhlaWdodCA+IGNjLkNhbnZhcy5pbnN0YW5jZS5kZXNpZ25SZXNvbHV0aW9uLndpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgIHVpRnVuYy5vcGVuVUkoXCJ1aU1hdGNoaW5nMnYyVmVyXCIsIGZ1bmN0aW9uKG9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hdGNoaW5nID0gb2JqLmdldENvbXBvbmVudChcInVpTWF0Y2hpbmcydjJWZXJcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGluZy5qb2luUmFuZG9tUm9vbSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB1aUZ1bmMub3BlblVJKFwidWlNYXRjaGluZzJ2MlZlclwiLCBmdW5jdGlvbihvYmopIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYXRjaGluZyA9IG9iai5nZXRDb21wb25lbnQoXCJ1aU1hdGNoaW5nMnYyVmVyXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hpbmcuam9pblJhbmRvbVJvb20oKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIGNyZWF0ZVJvb206IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoY2MuQ2FudmFzLmluc3RhbmNlLmRlc2lnblJlc29sdXRpb24uaGVpZ2h0ID4gY2MuQ2FudmFzLmluc3RhbmNlLmRlc2lnblJlc29sdXRpb24ud2lkdGgpIHtcbiAgICAgICAgICAgIHVpRnVuYy5vcGVuVUkoXCJ1aUNyZWF0ZVJvb21WZXJcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB1aUZ1bmMub3BlblVJKFwidWlDcmVhdGVSb29tXCIpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGpvaW5Sb29tOiBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKGNjLkNhbnZhcy5pbnN0YW5jZS5kZXNpZ25SZXNvbHV0aW9uLmhlaWdodCA+IGNjLkNhbnZhcy5pbnN0YW5jZS5kZXNpZ25SZXNvbHV0aW9uLndpZHRoKSB7XG4gICAgICAgICAgICB1aUZ1bmMub3BlblVJKFwidWlSb29tTGlzdFZlclwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHVpRnVuYy5vcGVuVUkoXCJ1aVJvb21MaXN0XCIpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIGludml0ZUZyaWVuZDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmKHdpbmRvdy53eCkge1xuICAgICAgICAgICAgd3guc2hhcmVBcHBNZXNzYWdlKHtpbWFnZVVybDogXCJodHRwczovL2RhdGEudGlhbnppeW91LmNvbS9tYXRjaHZzR2FtZXNSZXMvbG9nby9hbmltYWxDaGVja2VyTG9nbzEucG5nXCJ9KTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuIl19