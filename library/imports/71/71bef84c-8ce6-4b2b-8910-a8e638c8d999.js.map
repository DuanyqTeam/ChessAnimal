{"version":3,"sources":["../../../../../assets/common/script/assets/common/script/gameManager.js"],"names":["mvs","require","GLB","cc","Class","Component","blockInput","Game","GameManager","getComponent","BlockInputEvents","enabled","setTimeout","node","onLoad","game","addPersistRootNode","clientEvent","init","dataFunc","loadConfigs","view","enableAutoFullScreen","on","eventType","gameOver","leaveRoomNotify","leaveRoom","network","window","chooseNetworkMode","getRankDataListener","findPlayerByAccountListener","data","gameState","GameState","Play","userInfo","id","leaveRoomInfo","userId","isRoomOwner","Over","winFlag","gamePanel","uiFunc","findUI","isLoadGame","openUI","panel","panelScript","setData","bind","matchVsInit","response","initResponse","errorResponse","joinRoomResponse","joinRoomNotify","leaveRoomResponse","joinOverResponse","createRoomResponse","getRoomListResponse","getRoomDetailResponse","getRoomListExResponse","kickPlayerResponse","kickPlayerNotify","registerUserResponse","loginResponse","logoutResponse","sendEventNotify","networkStateNotify","result","engine","channel","platform","gameId","appKey","gameVersion","console","log","netNotify","owner","userID","state","obj","uiTip","PLAYER_FLAG","RED","BLUE","dispatch","leaveRoomMedNotify","kickPlayerRsp","status","rsp","roomInfos","joinOverRsp","roomUserInfoList","roomInfo","roomUserInfo","leaveRoomRsp","disconnect","removePersistRootNode","director","loadScene","error","msg","logout","registerUser","deviceId","gatewayId","login","token","info","lobbyShow","None","Canvas","instance","designResolution","height","width","cpProto","JSON","parse","indexOf","GAME_START_EVENT","playerUserIds","remoteUserIds","userIds","forEach","push","startGame","GAME_OVER_EVENT","EXIT","READY","readyCnt","length","sendRoundStartMsg","ROUND_START","roundStart","COUNT_TIME","updateTime","CHANGE_FLAG","changeFlag","SEND_MAP_INFO","param","mapInit","OPEN_FOR_OTHER","srcUserId","tag","sign","openForOther","EAT_FOR_OTHER","eatInfo","eatForOther","sendReadyMsg","action","sendEventEx","stringify","sendEvent","clearChess","timeLabelInit","recvMsg","uiRankPanel","rankArray","playerAccountGet","loginServer","isConnected","connect","IP","PORT","send","nickName","avatarUrl","userInfoReq","onDestroy","off"],"mappings":"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","sourceRoot":"../../../../../assets/common/script","sourcesContent":["var mvs = require(\"Matchvs\");\nvar GLB = require(\"Glb\");\n\ncc.Class({\n    extends: cc.Component,\n    blockInput() {\n        Game.GameManager.getComponent(cc.BlockInputEvents).enabled = true;\n        setTimeout(function() {\n            Game.GameManager.node.getComponent(cc.BlockInputEvents).enabled = false;\n        }, 1000);\n    },\n    onLoad() {\n        Game.GameManager = this;\n        cc.game.addPersistRootNode(this.node);\n        clientEvent.init();\n        dataFunc.loadConfigs();\n        cc.view.enableAutoFullScreen(false);\n        clientEvent.on(clientEvent.eventType.gameOver, this.gameOver, this);\n        clientEvent.on(clientEvent.eventType.leaveRoomNotify, this.leaveRoom, this);\n        this.network = window.network;\n        this.network.chooseNetworkMode();\n        this.getRankDataListener();\n        this.findPlayerByAccountListener();\n\n        // if(window.wx) {\n        //     wx.login({\n        //         success: function() {\n        //             wx.getUserInfo({\n        //                 fail: function(res) {\n        //                     // iOS 和 Android 对于拒绝授权的回调 errMsg 没有统一，需要做一下兼容处理\n        //                     if (res.errMsg.indexOf('auth deny') > -1 || res.errMsg.indexOf('auth denied') > -1) {\n        //                         // 处理用户拒绝授权的情况\n        //                     }\n        //                 },\n        //                 success: function(res) {\n        //                     Game.GameManager.nickName = res.userInfo.nickName;\n        //                     Game.GameManager.avatarUrl = res.userInfo.avatarUrl;\n        //                     console.log('success', Game.GameManager.nickName);\n        //                 }\n        //             });\n        //         }\n        //     });\n        // }\n    },\n\n    leaveRoom: function(data) {\n        // 离开房间--\n        if (this.gameState === GameState.Play) {\n            if (GLB.userInfo.id !== data.leaveRoomInfo.userId) {\n                GLB.isRoomOwner = true;\n                // var gamePanel = uiFunc.findUI(\"uiGamePanel\");\n                // if (gamePanel) {\n                //     var gamePanelScript = gamePanel.getComponent(\"uiGamePanel\");\n                //     gamePanelScript.otherScore = 0;\n                //     this.gameOver();\n                // }\n            }\n            else {\n                Game.GameManager.gameState = GameState.Over;\n            }\n        }\n    },\n\n    gameOver: function(winFlag) {\n        var gamePanel = uiFunc.findUI(\"uiGamePanel\");\n        if (gamePanel && Game.GameManager.gameState !== GameState.Over) {\n            Game.GameManager.gameState = GameState.Over\n        } else return;\n        this.isLoadGame = false;\n        // mvs.engine.leaveRoom();\n        setTimeout(function() {\n            uiFunc.openUI(\"uiVsResultVer\", function (panel) {\n                var panelScript = panel.getComponent('uiVsResult');\n                panelScript.setData(winFlag);\n            }.bind(this));\n        }.bind(this), 1000);\n    },\n\n    matchVsInit: function() {\n        mvs.response.initResponse = this.initResponse.bind(this);\n        mvs.response.errorResponse = this.errorResponse.bind(this);\n        mvs.response.joinRoomResponse = this.joinRoomResponse.bind(this);\n        mvs.response.joinRoomNotify = this.joinRoomNotify.bind(this);\n        mvs.response.leaveRoomResponse = this.leaveRoomResponse.bind(this);\n        mvs.response.leaveRoomNotify = this.leaveRoomNotify.bind(this);\n        mvs.response.joinOverResponse = this.joinOverResponse.bind(this);\n        mvs.response.createRoomResponse = this.createRoomResponse.bind(this);\n        mvs.response.getRoomListResponse = this.getRoomListResponse.bind(this);\n        mvs.response.getRoomDetailResponse = this.getRoomDetailResponse.bind(this);\n        mvs.response.getRoomListExResponse = this.getRoomListExResponse.bind(this);\n        mvs.response.kickPlayerResponse = this.kickPlayerResponse.bind(this);\n        mvs.response.kickPlayerNotify = this.kickPlayerNotify.bind(this);\n        mvs.response.registerUserResponse = this.registerUserResponse.bind(this);\n        mvs.response.loginResponse = this.loginResponse.bind(this); // 用户登录之后的回调\n        mvs.response.logoutResponse = this.logoutResponse.bind(this); // 用户登录之后的回调\n        mvs.response.sendEventNotify = this.sendEventNotify.bind(this);\n        mvs.response.networkStateNotify = this.networkStateNotify.bind(this);\n\n        // var result = mvs.engine.init(mvs.response, GLB.channel, GLB.platform, GLB.gameId);\n        var result = mvs.engine.init(mvs.response, GLB.channel, GLB.platform, GLB.gameId,\n            GLB.appKey, GLB.gameVersion);\n        if (result !== 0) {\n            console.log('初始化失败,错误码:' + result);\n        }\n        Game.GameManager.blockInput();\n\n    },\n\n    networkStateNotify: function(netNotify) {\n        console.log(\"netNotify\");\n        console.log(\"netNotify.owner:\" + netNotify.owner);\n        console.log(\"玩家：\" + netNotify.userID + \" state:\" + netNotify.state);\n        // if (Game.GameManager.gameState === GameState.Over) return;\n        if (netNotify.userID !== GLB.userInfo.id && Game.GameManager.gameState === GameState.Play) {\n            uiFunc.openUI(\"uiTip\", function(obj) {\n                var uiTip = obj.getComponent(\"uiTip\");\n                if (uiTip) {\n                    uiTip.setData(\"对方已退出\");\n                }\n            });\n\n\n            var winFlag;\n            if (GLB.isRoomOwner) {\n                winFlag = GLB.PLAYER_FLAG.RED;\n            } else {\n                winFlag = GLB.PLAYER_FLAG.BLUE;\n            }\n            // Game.GameManager.gameState = GameState.Over;\n            clientEvent.dispatch(clientEvent.eventType.gameOver, winFlag);\n\n        }\n        clientEvent.dispatch(clientEvent.eventType.leaveRoomMedNotify, netNotify);\n    },\n\n    kickPlayerNotify: function(kickPlayerNotify) {\n        var data = {\n            kickPlayerNotify: kickPlayerNotify\n        }\n        clientEvent.dispatch(clientEvent.eventType.kickPlayerNotify, data);\n    },\n\n    kickPlayerResponse: function(kickPlayerRsp) {\n        if (kickPlayerRsp.status !== 200) {\n            console.log(\"失败kickPlayerRsp:\" + kickPlayerRsp);\n            return;\n        }\n        var data = {\n            kickPlayerRsp: kickPlayerRsp\n        }\n        clientEvent.dispatch(clientEvent.eventType.kickPlayerResponse, data);\n    },\n\n    getRoomListExResponse: function(rsp) {\n        if (rsp.status !== 200) {\n            console.log(\"失败 rsp:\" + rsp);\n            return;\n        }\n        var data = {\n            rsp: rsp\n        }\n        clientEvent.dispatch(clientEvent.eventType.getRoomListExResponse, data);\n    },\n\n    getRoomDetailResponse: function(rsp) {\n        if (rsp.status !== 200) {\n            console.log(\"失败 rsp:\" + rsp);\n            return;\n        }\n        var data = {\n            rsp: rsp\n        }\n        clientEvent.dispatch(clientEvent.eventType.getRoomDetailResponse, data);\n    },\n\n    getRoomListResponse: function(status, roomInfos) {\n        if (status !== 200) {\n            console.log(\"失败 status:\" + status);\n            return;\n        }\n        var data = {\n            status: status,\n            roomInfos: roomInfos\n        }\n        clientEvent.dispatch(clientEvent.eventType.getRoomListResponse, data);\n    },\n\n    createRoomResponse: function(rsp) {\n        if (rsp.status !== 200) {\n            console.log(\"失败 createRoomResponse:\" + rsp);\n            return;\n        }\n        var data = {\n            rsp: rsp\n        }\n        clientEvent.dispatch(clientEvent.eventType.createRoomResponse, data);\n    },\n\n    joinOverResponse: function(joinOverRsp) {\n        if (joinOverRsp.status !== 200) {\n            console.log(\"失败 joinOverRsp:\" + joinOverRsp);\n            return;\n        }\n        var data = {\n            joinOverRsp: joinOverRsp\n        }\n        clientEvent.dispatch(clientEvent.eventType.joinOverResponse, data);\n    },\n\n    joinRoomResponse: function(status, roomUserInfoList, roomInfo) {\n        if (status !== 200) {\n            console.log(\"失败 joinRoomResponse:\" + status);\n            return;\n        }\n        var data = {\n            status: status,\n            roomUserInfoList: roomUserInfoList,\n            roomInfo: roomInfo\n        }\n        clientEvent.dispatch(clientEvent.eventType.joinRoomResponse, data);\n    },\n\n    joinRoomNotify: function(roomUserInfo) {\n        var data = {\n            roomUserInfo: roomUserInfo\n        }\n        clientEvent.dispatch(clientEvent.eventType.joinRoomNotify, data);\n    },\n\n    leaveRoomResponse: function(leaveRoomRsp) {\n        if (leaveRoomRsp.status !== 200) {\n            console.log(\"失败 leaveRoomRsp:\" + leaveRoomRsp);\n            return;\n        }\n        var data = {\n            leaveRoomRsp: leaveRoomRsp\n        }\n        clientEvent.dispatch(clientEvent.eventType.leaveRoomResponse, data);\n    },\n\n    leaveRoomNotify: function(leaveRoomInfo) {\n        var data = {\n            leaveRoomInfo: leaveRoomInfo\n        }\n        clientEvent.dispatch(clientEvent.eventType.leaveRoomNotify, data);\n    },\n\n    logoutResponse: function(status) {\n        Game.GameManager.network.disconnect();\n        cc.game.removePersistRootNode(this.node);\n        cc.director.loadScene('lobby');\n    },\n\n    errorResponse: function(error, msg) {\n        if (error === 1001 || error === 0) {\n            uiFunc.openUI(\"uiTip\", function(obj) {\n                var uiTip = obj.getComponent(\"uiTip\");\n                if (uiTip) {\n                    uiTip.setData(\"网络断开连接\");\n                }\n            });\n            setTimeout(function() {\n                mvs.engine.logout(\"\");\n                cc.game.removePersistRootNode(this.node);\n                cc.director.loadScene('lobby');\n            }.bind(this), 2500);\n        }\n        console.log(\"错误信息：\" + error);\n        console.log(\"错误信息：\" + msg);\n    },\n\n    initResponse: function() {\n        console.log('初始化成功，开始注册用户');\n        var result = mvs.engine.registerUser();\n        if (result !== 0) {\n            console.log('注册用户失败，错误码:' + result);\n        } else {\n            console.log('注册用户成功');\n        }\n    },\n\n    registerUserResponse: function(userInfo) {\n        var deviceId = 'abcdef';\n        var gatewayId = 0;\n        GLB.userInfo = userInfo;\n\n        console.log('开始登录,用户Id:' + userInfo.id)\n\n        /* var result = mvs.engine.login(\n            userInfo.id, userInfo.token,\n            GLB.gameId, GLB.gameVersion,\n            GLB.appKey, GLB.secret,\n            deviceId, gatewayId\n        ); */\n        var result = mvs.engine.login(userInfo.id, userInfo.token, deviceId);\n        if (result !== 0) {\n            console.log('登录失败,错误码:' + result);\n        }\n    },\n\n    loginResponse: function(info) {\n        if (info.status !== 200) {\n            console.log('登录失败,异步回调错误码:' + info.status);\n        } else {\n            console.log('登录成功');\n            this.lobbyShow();\n        }\n    },\n\n    lobbyShow: function() {\n        this.gameState = GameState.None;\n        // cc.director.loadScene('lobby')\n        if (cc.Canvas.instance.designResolution.height > cc.Canvas.instance.designResolution.width) {\n            uiFunc.openUI(\"uiLobbyPanelVer\");\n        } else {\n            uiFunc.openUI(\"uiLobbyPanel\");\n        }\n    },\n\n    // 收到的消息\n    sendEventNotify: function(info) {\n        console.log(info)\n        var cpProto = JSON.parse(info.cpProto);\n        if (info.cpProto.indexOf(GLB.GAME_START_EVENT) >= 0) {\n            GLB.playerUserIds = [GLB.userInfo.id]\n            var remoteUserIds = JSON.parse(info.cpProto).userIds;\n            remoteUserIds.forEach(function(id) {\n                if (GLB.userInfo.id !== id) {\n                    GLB.playerUserIds.push(id);\n                }\n            });\n            this.startGame();\n        }\n\n        if (info.cpProto.indexOf(GLB.GAME_OVER_EVENT) >= 0) {\n            console.log('********收到了游戏结束的消息********')\n            var winFlag = JSON.parse(info.cpProto).winFlag;\n            clientEvent.dispatch(clientEvent.eventType.gameOver, winFlag);\n            // this.gameOver(winFlag);\n        }\n\n        if (info.cpProto.indexOf(GLB.EXIT) >= 0) {\n            // if(info.srcUserId == GLB.userInfo.id) {\n            //     console.log('我退出了游戏')\n            //     this.isLoadGame = false;\n            //     return;\n            // }\n            console.log('********对方退出了游戏********')\n            uiFunc.openUI(\"uiTip\", function(obj) {\n                var uiTip = obj.getComponent(\"uiTip\");\n                if (uiTip) {\n                    uiTip.setData(\"对方已退出\");\n                }\n            });\n\n            var winFlag;\n            if (GLB.isRoomOwner) {\n                winFlag = GLB.PLAYER_FLAG.RED;\n            } else {\n                winFlag = GLB.PLAYER_FLAG.BLUE;\n            }\n            clientEvent.dispatch(clientEvent.eventType.gameOver, winFlag);\n        }\n\n        if (info.cpProto.indexOf(GLB.READY) >= 0) {\n            this.readyCnt++;\n            if (GLB.isRoomOwner && this.readyCnt >= GLB.playerUserIds.length) {\n                this.sendRoundStartMsg();\n            }\n        }\n\n        if (info.cpProto.indexOf(GLB.ROUND_START) >= 0) {\n            // setTimeout(function() {\n            //     Game.GameManager.gameState = GameState.Play;\n            // }.bind(this), 2000);\n            console.log('------dispatch roundStart------');\n            clientEvent.dispatch(clientEvent.eventType.roundStart);\n        }\n\n        if (info.cpProto.indexOf(GLB.COUNT_TIME) >= 0) {\n            clientEvent.dispatch(clientEvent.eventType.updateTime, JSON.parse(info.cpProto));\n        }\n        if (info.cpProto.indexOf(GLB.CHANGE_FLAG) >= 0) {\n            clientEvent.dispatch(clientEvent.eventType.changeFlag);\n        }\n        // if (info.cpProto.indexOf(GLB.CLEAR_CHESS) >= 0) {\n        //     clientEvent.dispatch(clientEvent.eventType.clearChess);\n        // }\n        if (info.cpProto.indexOf(GLB.SEND_MAP_INFO) >= 0) {\n            var param = JSON.parse(info.cpProto);\n            clientEvent.dispatch(clientEvent.eventType.mapInit, param);\n        }\n        if (info.cpProto.indexOf(GLB.OPEN_FOR_OTHER) >= 0) {\n            if(info.srcUserId == GLB.userInfo.id) return;\n            var tag = JSON.parse(info.cpProto).sign;\n            clientEvent.dispatch(clientEvent.eventType.openForOther, tag);\n        }\n        if (info.cpProto.indexOf(GLB.EAT_FOR_OTHER) >= 0) {\n            if(info.srcUserId == GLB.userInfo.id) return;\n            var eatInfo = JSON.parse(info.cpProto).eatInfo;\n            clientEvent.dispatch(clientEvent.eventType.eatForOther, eatInfo);\n        }\n    },\n\n    sendReadyMsg: function() {\n        var msg = {action: GLB.READY};\n        this.sendEventEx(msg);\n    },\n\n    sendRoundStartMsg: function() {\n        var msg = {action: GLB.ROUND_START};\n        this.sendEventEx(msg);\n    },\n\n    sendEventEx: function(msg) {\n        var result = mvs.engine.sendEventEx(0, JSON.stringify(msg), 0, GLB.playerUserIds);\n        if (result.result !== 0) {\n            console.log(msg.action, result.result);\n        }\n    },\n\n    sendEvent: function(msg) {\n        var result = mvs.engine.sendEvent(JSON.stringify(msg));\n        if (result.result !== 0) {\n            console.log(msg.action, result.result);\n        }\n    },\n\n    startGame: function() {\n        console.log('-----startGame-----')\n        if(this.isLoadGame) return;\n        this.isLoadGame = true;\n        this.readyCnt = 0;\n        cc.director.loadScene('game', function() {\n            clientEvent.dispatch(clientEvent.eventType.clearChess);\n            uiFunc.openUI(\"uiGamePanel\", function(panel) {\n                panel.getComponent(\"uiGamePanel\").timeLabelInit();\n\n                this.sendReadyMsg();\n            }.bind(this));\n        }.bind(this));\n    },\n\n    getRankDataListener: function() {\n        this.network.on(\"connector.rankHandler.getRankData\", function(recvMsg) {\n            uiFunc.openUI(\"uiRankPanelVer\", function(obj) {\n                var uiRankPanel = obj.getComponent(\"uiRankPanel\");\n                uiRankPanel.setData(recvMsg.rankArray);\n            });\n        }.bind(this));\n    },\n\n    findPlayerByAccountListener: function() {\n        this.network.on(\"connector.entryHandler.findPlayerByAccount\", function(recvMsg) {\n            clientEvent.dispatch(clientEvent.eventType.playerAccountGet, recvMsg);\n        });\n    },\n\n    loginServer: function() {\n        if (!this.network.isConnected()) {\n            this.network.connect(GLB.IP, GLB.PORT, function() {\n                    this.network.send(\"connector.entryHandler.login\", {\n                        \"account\": GLB.userInfo.id + \"\",\n                        \"channel\": \"0\",\n                        \"userName\": Game.GameManager.nickName ? Game.GameManager.nickName : GLB.userInfo.id + \"\",\n                        \"headIcon\": Game.GameManager.avatarUrl ? Game.GameManager.avatarUrl : \"-\"\n                    });\n                    setTimeout(function() {\n                        this.network.send(\"connector.rankHandler.updateScore\", {\n                            \"account\": GLB.userInfo.id + \"\",\n                            \"game\": \"game8\"\n                        });\n                    }.bind(this), 500);\n\n                }.bind(this)\n            );\n        } else {\n            this.network.send(\"connector.rankHandler.updateScore\", {\n                \"account\": GLB.userInfo.id + \"\",\n                \"game\": \"game8\"\n            });\n        }\n    },\n\n    userInfoReq: function(userId) {\n        if (!Game.GameManager.network.isConnected()) {\n            Game.GameManager.network.connect(GLB.IP, GLB.PORT, function() {\n                    Game.GameManager.network.send(\"connector.entryHandler.login\", {\n                        \"account\": GLB.userInfo.id + \"\",\n                        \"channel\": \"0\",\n                        \"userName\": Game.GameManager.nickName ? Game.GameManager.nickName : GLB.userInfo.id + \"\",\n                        \"headIcon\": Game.GameManager.avatarUrl ? Game.GameManager.avatarUrl : \"-\"\n                    });\n                    setTimeout(function() {\n                        Game.GameManager.network.send(\"connector.entryHandler.findPlayerByAccount\", {\n                            \"account\": userId + \"\",\n                        });\n                    }, 200);\n                }\n            );\n        } else {\n            Game.GameManager.network.send(\"connector.entryHandler.findPlayerByAccount\", {\n                \"account\": userId + \"\",\n            });\n        }\n    },\n\n\n    onDestroy() {\n        clientEvent.off(clientEvent.eventType.gameOver, this.gameOver, this);\n        clientEvent.off(clientEvent.eventType.leaveRoomNotify, this.leaveRoom, this);\n    }\n});\n"]}